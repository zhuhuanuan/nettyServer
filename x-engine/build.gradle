allprojects {

	apply plugin: 'java'
	apply plugin: 'idea'
	apply plugin: 'eclipse'
	apply plugin: 'findbugs'

	compileJava.options.encoding = 'UTF-8'

	sourceCompatibility = 1.8
	targetCompatibility = 1.8

	ext.projectName = "$name"

	repositories {
		maven { url 'http://maven.aliyun.com/nexus/content/groups/public/' }
        jcenter()
	}

	dependencies {
		compile group: 'com.typesafe.akka', name: 'akka-actor_2.12', version: '2.5.13'
		compile group: 'redis.clients', name: 'jedis', version: '3.0.0'
		compile group: 'com.google.protobuf', name: 'protobuf-java', version:'3.5.1'
		compile group: 'io.netty', name: 'netty-all', version: '4.1.6.Final'
		compile group: 'org.springframework', name: 'spring-context', version: '5.0.7.RELEASE'
		compile group: 'org.springframework', name: 'spring-core', version: '5.0.7.RELEASE'
		compile group: 'org.springframework', name: 'spring-beans', version: '5.0.7.RELEASE'
		compile group: 'org.springframework', name: 'spring-context-support', version: '5.0.7.RELEASE'
		compile group: 'org.springframework', name: 'spring-jdbc', version: '5.0.7.RELEASE'
		compile group: 'mysql', name: 'mysql-connector-java', version: '8.0.11'
		compile group: 'org.codehaus.groovy', name: 'groovy-all', version: '2.4.15'
		compile group: 'com.mchange', name: 'c3p0', version: '0.9.5.2'
		compile group: 'com.alibaba', name: 'druid', version: '1.1.10'
		compile group: 'ch.qos.logback', name: 'logback-core', version: '1.2.3'
		compile group: 'ch.qos.logback', name: 'logback-classic', version: '1.2.3'
		compile group: 'org.apache.poi', name: 'poi', version: '3.17'
		compile group: 'org.apache.poi', name: 'poi-ooxml', version: '3.16-beta2'
		compile group: 'org.apache.poi', name: 'poi', version: '3.16-beta2'
		compile group: 'org.apache.poi', name: 'poi-ooxml', version: '3.17'		
		compile group: 'xml-apis', name: 'xml-apis', version: '2.0.2'
		compile group: 'com.google.guava', name: 'guava', version: '25.1-jre'
		compile group: 'com.alibaba', name: 'QLExpress', version: '3.2.0'
		compile group: 'com.alibaba', name: 'fastjson', version: '1.2.47'
		compile group: 'com.typesafe', name: 'config', version: '1.3.3'
		compile group: 'org.slf4j', name: 'slf4j-api', version: '1.7.25'
		compile group: 'org.apache.commons', name: 'commons-lang3', version: '3.7'
		compile group: 'commons-beanutils', name: 'commons-beanutils', version: '1.9.3'
		compile group: 'commons-codec', name: 'commons-codec', version: '1.11'
		compile group: 'org.apache.commons', name: 'commons-collections4', version: '4.1'
		compile group: 'org.apache.commons', name: 'commons-compress', version: '1.17'
		compile group: 'commons-dbutils', name: 'commons-dbutils', version: '1.7'
		compile group: 'commons-logging', name: 'commons-logging', version: '1.2'
		compile group: 'commons-net', name: 'commons-net', version: '3.6'
		compile group: 'org.apache.commons', name: 'commons-pool2', version: '2.5.0'
		compile group: 'org.scala-lang', name: 'scala-library', version: '2.12.6'
		compile group: 'org.springframework.amqp', name: 'spring-rabbit', version: '2.0.4.RELEASE'
		compile group: 'com.esotericsoftware', name: 'kryo', version: '4.0.2'
		compile group: 'com.googlecode.concurrentlinkedhashmap', name: 'concurrentlinkedhashmap-lru', version: '1.4.2'
		compile group: 'org.quartz-scheduler', name: 'quartz', version: '2.3.0'
		compile group: 'org.bouncycastle', name: 'bcprov-jdk15', version:'1.46'
		compile group: 'org.jctools', name: 'jctools-core', version: '2.1.2'
		compile group: 'org.javassist', name: 'javassist', version: '3.23.1-GA'
		compile group: 'org.apache.commons', name: 'commons-configuration2', version: '2.1.1'
		
		compile(
			fileTree(dir: '../libs', include: '*.jar'),
		)
		
		compileOnly group: 'org.projectlombok', name: 'lombok', version: '1.18.0'
	}
	
	// findbugs
	tasks.withType(FindBugs) {
		ignoreFailures = true
		reports {
			xml.enabled = false
			html.enabled = true
		}
		reportLevel = "high"
	}
	//tasks.withType(Compile) {  
	//	options.encoding = "UTF-8"  
	//}

}

subprojects {

	sourceSets.main.java.srcDirs = ["src", "conf"]

	task initPath {
		sourceSets.main.java.srcDirs.each { it.mkdirs() }
	}
	//清除上次的编译过的文件
	task clearPj(type:Delete){
		delete 'build','target'
	}
	task copyJar(type:Copy){
		from configurations.runtime
		into ('build/libs/lib')
	}
	//把JAR复制到目标目录
	task release(type: Copy,dependsOn: [build,copyJar]) {
	 from 'conf'
	 into ('build/libs/conf') // 目标位置
	}
	task export(type:Copy) {
		from 'build/libs'
		into '../export/' +  projectName                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
	}
	
	task zip(type: Zip) {
    from 'build/libs'
    //into('libs') {
        //from configurations.runtime
    //}
	}
	
	task copyzip(type:Copy) {
		from 'build/distributions'
		into '../export/zip/'
	}
}
